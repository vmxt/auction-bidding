<div class="col-12">
	
	<h4 class="bg-secondary text-light p-3">Current and Past Customers (List at least three)</h4>
    <div class="field_wrapper7">
        <label class="bg-dark text-light p-2">Major Customer: <span class="field-req">*</span></label><br>
        <div class="row mc_wrap">
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_institution" placeholder="Institution" name="cpc_institution" 
                id="cpc_institution">
            </div>
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_address" placeholder="Address" name="cpc_address"
                id="cpc_address">
            </div>
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_number" placeholder="Contact Number" name="cpc_telephone" id="cpc_telephone">
            </div>
            <div class="col-md-3 form-group">
              <input type="email" class="form-control mc_email" placeholder="Email Address" name="cpc_email"
                id="cpc_email">
            </div>
        </div>
        <div class="row mc_wrap">                                                
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_institution" placeholder="Institution" name="cpc_institution1" id="cpc_institution1">
            </div>
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_address" placeholder="Address" name="cpc_address1" 
                id="cpc_address1">
            </div>
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_number" placeholder="Contact Number" name="cpc_telephone1" id="cpc_telephone1">
            </div>
            <div class="col-md-3 form-group">
              <input type="email" class="form-control mc_email" placeholder="Email Address" name="cpc_email1" id="cpc_email1">
            </div>
        </div>
        <div class="row mc_wrap">
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_institution" placeholder="Institution" name="cpc_institution2" id="cpc_institution2">
            </div>
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_address" placeholder="Address" name="cpc_address2"
                id="cpc_address2">
            </div>
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_number" placeholder="Contact Number" name="cpc_telephone2"
                id="cpc_telephone2">
            </div>
            <div class="col-md-3 form-group">
              <input type="email" class="form-control mc_email" placeholder="Email Address" name="cpc_email2" id="cpc_email2">
            </div>
        </div>
        <div class="row mc_wrap">
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_institution" placeholder="Institution" name="cpc_institution3"
                id="cpc_institution3">
            </div>
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_address" placeholder="Address" name="cpc_address3"
                id="cpc_address3">
            </div>
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_number" placeholder="Contact Number" name="cpc_telephone3"
                id="cpc_telephone3">
            </div>
            <div class="col-md-3 form-group">
              <input type="email" class="form-control mc_email" placeholder="Email Address" name="cpc_email3" id="cpc_email3">
            </div>
        </div>
        <div class="row mc_wrap"> 
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_institution" placeholder="Institution" name="cpc_telephone4"
                id="cpc_institution4">
            </div>
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_address" placeholder="Address" name="cpc_address4" 
                id="cpc_address4">
            </div>
            <div class="col-md-3 form-group">
              <input type="text" class="form-control mc_number" placeholder="Contact Number" name="cpc_telephone4" 
                id="cpc_telephone4">
            </div>
            <div class="col-md-3 form-group">
              <input type="email" class="form-control mc_email" placeholder="Email Address" name="cpc_email4" id="cpc_email4">
            </div>
        </div>
    </div>
    <a href="javascript:void(0);" class="add_button7 btn btn-success mt-2" title="Add field">Add <i class="icon-plus-circle"></i></a>

    <div class="field_wrapper8 mt-3">
	<label class="bg-dark text-light p-2">Customer of Last Three Years: <span class="field-req">*</span></label><br>
	<div class="row clty_wrap">
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_inst" placeholder="Institution" name="clty_institution"
	        id="clty_institution">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_addr" placeholder="Address" name="clty_address" 
	        id="clty_address">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_cnum" placeholder="Contact Number" name="clty_telephone"id="clty_telephone">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="email" class="form-control clty_eaddr" placeholder="Email Address" name="clty_email" id="clty_email">
	    </div>
	</div>
	<div class="row clty_wrap">
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_inst" placeholder="Institution" name="clty_institution1" id="clty_institution1">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_addr" placeholder="Address" name="clty_address1" id="clty_address1">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_cnum" placeholder="Contact Number" name="clty_telephone1" id="clty_telephone1">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="email" class="form-control clty_eaddr" placeholder="Email Address" name="clty_email1" id="clty_email1">
	    </div>
	</div>
	<div class="row clty_wrap">
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_inst" placeholder="Institution" name="clty_institution2"
	        id="clty_institution2">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_addr" placeholder="Address" name="clty_address2"
	        id="clty_address2">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_cnum" placeholder="Contact Number" name="clty_telephone2"
	        id="clty_telephone2">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="email" class="form-control clty_eaddr" placeholder="Email Address" name="clty_email2" id="clty_email2">
	    </div>
	</div>
	<div class="row clty_wrap">
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_inst" placeholder="Institution" name="clty_institution3"
	        id="clty_institution3">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_addr" placeholder="Address" name="clty_address3" 
	        id="clty_address3">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_cnum" placeholder="Contact Number" name="clty_telephone3"
	        id="clty_telephone3">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="email" class="form-control clty_eaddr" placeholder="Email Address" name="clty_email3" id="clty_email3">
	    </div>
	</div>
	<div class="row clty_wrap">
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_inst" placeholder="Institution" name="clty_institution4" 
	        id="clty_institution4">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_addr" placeholder="Address" name="clty_address4"
	        id="clty_address4">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="text" class="form-control clty_cnum" placeholder="Contact Number" name="clty_telephone4"
	        id="clty_telephone4">
	    </div>
	    <div class="col-md-3 form-group">
	      <input type="email" class="form-control clty_eaddr" placeholder="Email Address" name="clty_email4" id="clty_email4">
	    </div>
	</div>
	</div>
	<a href="javascript:void(0);" class="add_button8 btn btn-success mt-2" title="Add field">Add <i class="icon-plus-circle"></i></a>

</div>

<script type="text/javascript">
  
    var js_supplier_mc  = {!! $supplier_mc !!};
    var js_supplier_lty = {!! $supplier_lty !!}; 
    sections.customers  = {};
    sections.customers.major = js_supplier_mc;
    sections.customers.last_three_years = js_supplier_lty;
    _sections.customers = {};

    if(js_supplier_mc.length>0) {

          $.each(js_supplier_mc, function(key, val) {

              if(key == 0) {
                  $('#cpc_institution').val(val.name);
                  $('#cpc_address').val(val.address);
                  $('#cpc_telephone').val(val.phone);
                  $('#cpc_email').val(val.email);
                  $('#cpc_institution').parent().parent().attr('data-action', 'update');
                  $('#cpc_institution').parent().parent().attr('data-id', val.id);
              } else if( key < 5 ) {
                  $('#cpc_institution'+key).val(val.name);
                  $('#cpc_address'+key).val(val.address);
                  $('#cpc_telephone'+key).val(val.phone);
                  $('#cpc_email'+key).val(val.email);
                  $('#cpc_institution'+key).parent().parent().attr('data-action', 'update');
                  $('#cpc_institution'+key).parent().parent().attr('data-id', val.id);
              } else {
                  var mc_html  = '<div class="row mc_wrap" data-action="update" data-id="'+val.id+'"><div class="col-md-3 form-group">';
                      mc_html += '<input type="text" class="form-control mc_institution" placeholder="Institution" id="cpc_institution'+key+'" name="cpc_institution'+key+'" value="'+val.name+'"></div>';
                      mc_html += '<div class="col-md-3 form-group"><input type="text" class="form-control mc_address" placeholder="Address" id="cpc_address'+key+'" name="cpc_address'+key+'" value="'+val.address+'"></div>';
                      mc_html += '<div class="col-10 col-md-3 form-group"><input type="text" class="form-control mc_number" placeholder="Contact Number" id="cpc_telephone'+key+'" name="cpc_telephone'+key+'" value="'+val.phone+'">';
                      mc_html += '</div>';
                      mc_html += '<div class="col-10 col-md-2 form-group"><input type="email" class="form-control mc_email" placeholder="Email Address" id="cpc_email'+key+'" name="cpc_email'+key+'" value="'+val.email+'">';
                      mc_html += '</div>';
                      mc_html += '<div class="col-1 p-0 form-group">';
                      mc_html += '<a href="javascript:void(0);" class="remove_button7 btn btn-danger" title="Remove field"><i class="icon-minus-circle"></i></a></div></div>'; //New input field html 
                  
                  $('.field_wrapper7').append(mc_html); //Add field html
              }

          });
      }


      if(js_supplier_lty.length>0) {

          $.each(js_supplier_lty, function(key, val) {

              if(key == 0) {
                  $('#clty_institution').val(val.name);
                  $('#clty_address').val(val.address);
                  $('#clty_telephone').val(val.phone);
                  $('#clty_email').val(val.email);
                  $('#clty_institution').parent().parent().attr('data-action', 'update');
                  $('#clty_institution').parent().parent().attr('data-id', val.id);
              } else if( key < 5 ) {
                  $('#clty_institution'+key).val(val.name);
                  $('#clty_address'+key).val(val.address);
                  $('#clty_telephone'+key).val(val.phone);
                  $('#clty_email'+key).val(val.email);
                  $('#clty_institution'+key).parent().parent().attr('data-action', 'update');
                  $('#clty_institution'+key).parent().parent().attr('data-id', val.id);
              } else {
                  var lty_html  = '<div class="row clty_wrap" data-action="update" data-id="'+val.id+'"><div class="col-md-3 form-group">';
                      lty_html += '<input type="text" class="form-control clty_inst" placeholder="Institution" id="clty_institution'+key+'" name="clty_institution'+key+'" value="'+val.name+'"></div>';
                      lty_html += '<div class="col-md-3 form-group"><input type="text" class="form-control clty_addr" placeholder="Address" id="clty_address'+key+'" name="clty_address'+key+'" value="'+val.address+'"></div>';
                      lty_html += '<div class="col-md-3 form-group"><input type="text" class="form-control clty_cnum" placeholder="Contact Number" id="clty_telephone'+key+'" name="clty_telephone'+key+'" value="'+val.phone+'"></div>';
                      lty_html += '<div class="col-md-2 form-group"><input type="email" class="form-control clty_eaddr" placeholder="Email Address" id="clty_email'+key+'" name="clty_email'+key+'" value="'+val.email+'">';
                      lty_html += '</div><div class="col-1 p-0 form-group"><a href="javascript:void(0);" class="remove_button8 btn btn-danger" title="Remove field">';
                      lty_html += '<i class="icon-minus-circle"></i></a></div></div>';
                      $('.field_wrapper8').append(lty_html); //Add field html 
              }

          });

      }

    function getCustomers() {

      var _mc  = [];
      var _lty = [];

      $('.mc_wrap').each(function(k,v){

        let _action         = $(this).data('action');
        let _institution    = $(this).children().children('.mc_institution').val();
        let _address        = $(this).children().children('.mc_address').val();
        let _number         = $(this).children().children('.mc_number').val();
        let _email          = $(this).children().children('.mc_email').val();
        let _exist  = false;
        let _id     = null;

        if( _action == 'update' ) {

            _id = $(this).data('id');

            $.each(js_supplier_mc, function(k,v){

                if( v.id == _id ) {

                    _exist = true;

                    if ( v.name != _institution || v.address != _address
                          || v.phone != _number || v.email != _email ) {

                        _mc.push({
                            'institution' : _institution ,
                            'address'     : _address ,
                            'phone'       : _number ,
                            'email'       : _email ,
                            'action'      : _action ,
                            'id'          : _id
                        });

                    }

                    return false;

                }

            });

        } else {

            if( _institution != "" ) {
              $(this).attr('data-action', "new");
              _mc.push({
                  'institution' : _institution ,
                  'address'     : _address ,
                  'phone'       : _number ,
                  'email'       : _email ,
                  'action'      : "new" ,
                  'id'          : _id
              });
            }

        }


        $.each(js_supplier_mc, function(key, val) {

            let is_match = false;

            $('.mc_wrap').each( function() {

                if( $(this).data('action') == 'update' ) {
                    if( val.id == $(this).data('id') ) {
                        is_match = true;
                    }
                }

            });

            if( !is_match ) {

                _mc.push({
                  'institution' : val.institution ,
                  'address'     : val.address ,
                  'phone'       : val.phone ,
                  'email'       : val.email ,
                  'action'      : _action ,
                  'id'          : _id
              });

            }
        });

        _sections.customers.major = _mc;

      });

      $('.clty_wrap').each(function(k,v){

        let _action         = $(this).data('action');
        let _institution    = $(this).children().children('.clty_inst').val();
        let _address        = $(this).children().children('.clty_addr').val();
        let _number         = $(this).children().children('.clty_cnum').val();
        let _email          = $(this).children().children('.clty_eaddr').val();
        let _exist  = false;
        let _id     = null;

        console.log(_action);

        if( _action == 'update' ) {

            _id = $(this).data('id');

            $.each(js_supplier_lty, function(k,v){

                if( v.id == _id ) {

                    _exist = true;

                    if ( v.name != _institution || v.address != _address
                          || v.phone != _number || v.email != _email ) {

                        _lty.push({
                            'institution' : _institution ,
                            'address'     : _address ,
                            'phone'       : _number ,
                            'email'       : _email ,
                            'action'      : _action ,
                            'id'          : _id
                        });

                    }

                    return false;

                }

            });

        } else {

            if( _institution != "" ) {
              $(this).attr('data-action', "new");
              _lty.push({
                  'institution' : _institution ,
                  'address'     : _address ,
                  'phone'       : _number ,
                  'email'       : _email ,
                  'action'      : "new" ,
                  'id'          : _id
              });
            }

        }


        $.each(js_supplier_lty, function(key, val) {

            let is_match = false;

            $('.clty_wrap').each( function() {

                if( $(this).data('action') == 'update' ) {
                    if( val.id == $(this).data('id') ) {
                        is_match = true;
                    }
                }

            });

            if( !is_match ) {

                _lty.push({
                  'institution' : val.institution ,
                  'address'     : val.address ,
                  'phone'       : val.phone ,
                  'email'       : val.email ,
                  'action'      : _action ,
                  'id'          : _id
              });

            }
        });

        _sections.customers.last_three_years = _lty;

      });

    }

</script>